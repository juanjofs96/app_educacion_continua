{"version":3,"sources":["webpack:///src/app/pages/login/login.page.html","webpack:///src/app/pages/login/login-routing.module.ts","webpack:///src/app/pages/login/login.module.ts","webpack:///src/app/pages/login/login.page.scss","webpack:///src/app/pages/login/login.page.ts"],"names":["routes","path","component","LoginPageRoutingModule","imports","forChild","exports","LoginPageModule","declarations","LoginPage","router","platform","google","fireAuth","fb","App","alertController","email","pass","data","self","url","done","user","error","id_User","id","habilitarOpciones","alertError","mensaje","res","navigationExtras","queryParams","JSON","stringify","navigate","is","params","login","then","response","idToken","accessToken","onLoginSuccess","console","log","alert","loginGoogleWeb","loginFacebookAndroid","loginFacebookWeb","auth","signInWithPopup","GoogleAuthProvider","verificarCuenta","additionalUserInfo","profile","facebookCredential","FacebookAuthProvider","credential","authResponse","signInWithCredential","resConfirmed","accessSecret","estadoUser","i","listMenu","length","disable","listTabs","msg","msg2","create","header","message","buttons","present","selector","template"],"mappings":"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","file":"pages-login-login-module-es5.js","sourcesContent":["export default \"<ion-content>\\r\\n  <div class=\\\"vertical-center\\\">\\r\\n    <img src=\\\"assets/images/LogoCEC.png\\\" class=\\\"smallLogo\\\" />\\r\\n  </div>\\r\\n  <ion-text color=\\\"primary\\\" class=\\\"color-h3\\\">\\r\\n    <h3>Iniciar Sesión</h3>\\r\\n  </ion-text>\\r\\n    <ion-list>\\r\\n      <ion-item>\\r\\n        <ion-label position=\\\"stacked\\\">Correo electrónico</ion-label>\\r\\n        <ion-input [(ngModel)]=\\\"email\\\" name=\\\"correo\\\" autocomplete=\\\"on\\\" type=\\\"email\\\"><ion-icon name=\\\"mail-outline\\\"></ion-icon></ion-input>\\r\\n      </ion-item>\\r\\n\\r\\n      <ion-item>\\r\\n        <ion-label position=\\\"stacked\\\">Contraseña</ion-label>\\r\\n        <ion-input [(ngModel)]=\\\"pass\\\" autocomplete=\\\"off\\\" name=\\\"clave\\\" type=\\\"password\\\"><ion-icon name=\\\"keypad-outline\\\"></ion-icon></ion-input>\\r\\n      </ion-item>\\r\\n\\r\\n      <ion-item lines=\\\"none\\\">\\r\\n        <a routerLink=\\\"/educ/home/\\\" slot=\\\"end\\\">No iniciar sesión</a>\\r\\n      </ion-item>\\r\\n    </ion-list>\\r\\n    <ion-button expand=\\\"block\\\" color=\\\"primary\\\" class=\\\"ion-padding-horizontal\\\" (click)=\\\"login()\\\">Iniciar Sesión</ion-button>\\r\\n\\r\\n  <!--header class=\\\"ion-padding-start ion-padding-top\\\"></!--header-->\\r\\n  <ion-button expand=\\\"block\\\" color=\\\"tertiary\\\" (click)=\\\"loginFacebook()\\\" class=\\\"ion-padding-horizontal\\\">\\r\\n    <ion-icon slot=\\\"start\\\" name=\\\"logo-facebook\\\"></ion-icon>\\r\\n    Iniciar Sesión con Facebook\\r\\n  </ion-button>\\r\\n\\r\\n  <ion-button expand=\\\"block\\\" color=\\\"danger\\\" (click)=\\\"loginGoogle()\\\" class=\\\"ion-padding-horizontal\\\">\\r\\n    <ion-icon slot=\\\"start\\\" name=\\\"logo-google\\\"></ion-icon>\\r\\n    Iniciar Sesión con Google\\r\\n  </ion-button>\\r\\n\\r\\n  <section>\\r\\n    <header class=\\\"ion-padding-start ion-padding-top\\\">¿Eres nuevo?</header>\\r\\n    <ion-button expand=\\\"block\\\" color=\\\"primary\\\" class=\\\"ion-padding-horizontal\\\" routerLink=\\\"/signup\\\">\\r\\n      Crear nueva cuenta</ion-button>\\r\\n  </section>\\r\\n</ion-content>\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: LoginPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class LoginPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { LoginPageRoutingModule } from './login-routing.module';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    LoginPageRoutingModule\r\n  ],\r\n  declarations: [LoginPage]\r\n})\r\nexport class LoginPageModule {}\r\n","export default \"ion-content {\\n  --ion-background-color: #ECECEC;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvbG9naW4vbG9naW4ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksK0JBQUE7QUFDSiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2xvZ2luL2xvZ2luLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImlvbi1jb250ZW50IHtcclxuICAgIC0taW9uLWJhY2tncm91bmQtY29sb3I6ICNFQ0VDRUM7XHJcbiAgfVxyXG5cclxuIl19 */\";","import { Component,OnInit } from '@angular/core';\r\nimport { NavigationExtras, Router} from '@angular/router';\r\nimport { GooglePlus } from '@ionic-native/google-plus/ngx';\r\nimport { AngularFireAuth } from '@angular/fire/auth';\r\nimport * as firebase from 'firebase/app';\r\nimport { Platform } from '@ionic/angular';\r\nimport { Facebook, FacebookLoginResponse } from '@ionic-native/facebook/ngx';\r\nimport { AppComponent } from \"../../app.component\";\r\nimport * as $ from \"jquery\";\r\nimport { AlertController } from '@ionic/angular';\r\nimport {environment} from '../../../environments/environment';\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.page.html',\r\n  styleUrls: ['./login.page.scss'],\r\n})\r\n\r\nexport class LoginPage implements OnInit {\r\n  loading: any;\r\n  public id_user: string;\r\n  private email: string = \"\";\r\n  private pass: string = \"\";\r\n  constructor(\r\n    private router: Router,\r\n    private platform: Platform,\r\n    private google: GooglePlus,\r\n    private fireAuth: AngularFireAuth,\r\n    private fb: Facebook,\r\n    private App: AppComponent,\r\n    private alertController: AlertController\r\n  ) {\r\n  \r\n  }\r\n\r\nngOnInit() {\r\n\r\n  }\r\n\r\n  async login() {\r\n    var data={\r\n      \"correo\":this.email,\r\n      \"clave\":this.pass\r\n    }\r\n    var self = this;\r\n    var url=environment.url+\"/api/login_participante/\"\r\n    await $.post(url,data).done(function (user) {\r\n          if(!user.error){\r\n            self.App.id_User = user.id;\r\n            self.habilitarOpciones();\r\n          }          \r\n         else{\r\n          self.alertError(user.mensaje,\"Credenciales incorrectas\");\r\n         }\r\n    });\r\n  }\r\n\r\n  async verificarCuenta(res:any) {\r\n    var self = this;\r\n    \r\n    var data ={\r\n      \"correo\":res['email'],\r\n      \"nombres\":res['given_name'],\r\n      \"apellidos\":res['family_name']\r\n    }\r\n    await $.post(environment.url+\"/api/existe_participante/\",data).done( function (user) {\r\n          if(!user.error){\r\n            self.App.id_User = user.id;\r\n            self.habilitarOpciones();\r\n          }\r\n          else{\r\n            let navigationExtras: NavigationExtras = {\r\n              queryParams: {\r\n                user: JSON.stringify(data)\r\n              }\r\n            };\r\n            self.alertError(\"Complete los datos faltantes para completar su registro\",\"Inicio exitoso\");\r\n            self.router.navigate([\"/signup/\"],navigationExtras);\r\n          }\r\n  })\r\n}\r\n\r\n  async loginGoogle() {\r\n    let params;\r\n    if (this.platform.is('android')) {\r\n      params = {\r\n        'webClientId': '44397923925-udqfaidjvqhp8p7ule0oihpn4i3co6je.apps.googleusercontent.com',\r\n        'offline': true\r\n      }\r\n      this.google.login(params)\r\n        .then((response) => {\r\n          const { idToken, accessToken } = response\r\n          this.onLoginSuccess(idToken, accessToken);\r\n        }).catch((error) => {\r\n          console.log(error)\r\n          alert('error:' + JSON.stringify(error))\r\n        });\r\n    }\r\n    else {\r\n      this.loginGoogleWeb();\r\n    }\r\n  }\r\n\r\n  loginFacebook() {\r\n    if (this.platform.is('android')) {\r\n      this.loginFacebookAndroid();\r\n    } else {\r\n      this.loginFacebookWeb();\r\n    }\r\n  }\r\n\r\n  async loginGoogleWeb() {\r\n    const res = await this.fireAuth.auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());\r\n    this.verificarCuenta(res.additionalUserInfo.profile);\r\n  }\r\n\r\n  async loginFacebookAndroid() {\r\n    const res: FacebookLoginResponse = await this.fb.login(['public_profile', 'email']);\r\n    const facebookCredential = firebase.auth.FacebookAuthProvider.credential(res.authResponse.accessToken);\r\n    const resConfirmed = await this.fireAuth.auth.signInWithCredential(facebookCredential);\r\n    this.verificarCuenta(resConfirmed.additionalUserInfo.profile);\r\n  }\r\n\r\n  async loginFacebookWeb() {\r\n    const res = await this.fireAuth.auth.signInWithPopup(new firebase.auth.FacebookAuthProvider());\r\n    this.verificarCuenta(res.additionalUserInfo.profile);\r\n  }\r\n\r\n  onLoginSuccess(accessToken, accessSecret) {\r\n    const credential = accessSecret ? firebase.auth.GoogleAuthProvider\r\n      .credential(accessToken, accessSecret) : firebase.auth.GoogleAuthProvider\r\n        .credential(accessToken);\r\n    this.fireAuth.auth.signInWithCredential(credential)\r\n      .then((response) => {\r\n        this.verificarCuenta(response.additionalUserInfo.profile);\r\n      })\r\n  }\r\n\r\n\r\n\r\n  habilitarOpciones() {\r\n    this.App.estadoUser = true;\r\n    for (let i = 0; i < this.App.listMenu.length; i++) {\r\n      this.App.listMenu[i].disable = false;\r\n    }\r\n\r\n    for (let i = 0; i < this.App.listTabs.length; i++) {\r\n      this.App.listTabs[i].disable = false;\r\n    }\r\n    this.router.navigate([\"/educ/home/\"]);\r\n  }\r\n\r\n  async alertError(msg:string,msg2:string) {\r\n    const alert = await this.alertController.create({\r\n      header: msg2,\r\n      message: msg,\r\n      buttons: ['OK']\r\n    });\r\n\r\n    await alert.present();\r\n  }\r\n\r\n}\r\n\r\n"]}