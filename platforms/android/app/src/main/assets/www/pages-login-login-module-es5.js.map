{"version":3,"sources":["webpack:///src/app/pages/login/login.page.html","webpack:///src/app/pages/login/login-routing.module.ts","webpack:///src/app/pages/login/login.module.ts","webpack:///src/app/pages/login/login.page.scss","webpack:///src/app/pages/login/login.page.ts"],"names":["routes","path","component","LoginPageRoutingModule","imports","forChild","exports","LoginPageModule","forRoot","declarations","LoginPage","router","platform","google","fireAuth","fb","App","alertController","email","pass","data","self","url","done","user","error","id_User","id","habilitarOpciones","storage","set","correo","clave","get","then","value","console","log","alertError","mensaje","res","navigationExtras","queryParams","JSON","stringify","navigate","is","params","login","response","idToken","accessToken","onLoginSuccess","alert","loginGoogleWeb","loginFacebookAndroid","loginFacebookWeb","auth","signInWithPopup","GoogleAuthProvider","verificarCuenta","additionalUserInfo","profile","facebookCredential","FacebookAuthProvider","credential","authResponse","signInWithCredential","resConfirmed","accessSecret","estadoUser","i","listMenu","length","disable","listTabs","msg","msg2","create","header","message","buttons","present","selector","template"],"mappings":"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","file":"pages-login-login-module-es5.js","sourcesContent":["export default \"<ion-content>\\n  <div class=\\\"vertical-center\\\">\\n    <img src=\\\"assets/images/LogoCEC.png\\\" class=\\\"smallLogo\\\" />\\n  </div>\\n  <ion-text color=\\\"primary\\\" class=\\\"color-h3\\\">\\n    <h3>Iniciar Sesión</h3>\\n  </ion-text>\\n    <ion-list>\\n      <ion-item>\\n        <ion-label position=\\\"stacked\\\">Correo electrónico</ion-label>\\n        <ion-input [(ngModel)]=\\\"email\\\" name=\\\"correo\\\" autocomplete=\\\"on\\\" type=\\\"email\\\"><ion-icon name=\\\"mail-outline\\\"></ion-icon></ion-input>\\n      </ion-item>\\n\\n      <ion-item>\\n        <ion-label position=\\\"stacked\\\">Contraseña</ion-label>\\n        <ion-input [(ngModel)]=\\\"pass\\\" autocomplete=\\\"off\\\" name=\\\"clave\\\" type=\\\"password\\\"><ion-icon name=\\\"keypad-outline\\\"></ion-icon></ion-input>\\n      </ion-item>\\n\\n      <ion-item lines=\\\"none\\\">\\n        <a routerLink=\\\"/educ/home/\\\" slot=\\\"end\\\">No iniciar sesión</a>\\n      </ion-item>\\n    </ion-list>\\n    <ion-button expand=\\\"block\\\" color=\\\"primary\\\" class=\\\"ion-padding-horizontal\\\" (click)=\\\"login()\\\">Iniciar Sesión</ion-button>\\n\\n  <!--header class=\\\"ion-padding-start ion-padding-top\\\"></!--header-->\\n  <ion-button expand=\\\"block\\\" color=\\\"tertiary\\\" (click)=\\\"loginFacebook()\\\" class=\\\"ion-padding-horizontal\\\">\\n    <ion-icon slot=\\\"start\\\" name=\\\"logo-facebook\\\"></ion-icon>\\n    Iniciar Sesión con Facebook\\n  </ion-button>\\n\\n  <ion-button expand=\\\"block\\\" color=\\\"danger\\\" (click)=\\\"loginGoogle()\\\" class=\\\"ion-padding-horizontal\\\">\\n    <ion-icon slot=\\\"start\\\" name=\\\"logo-google\\\"></ion-icon>\\n    Iniciar Sesión con Google\\n  </ion-button>\\n\\n  <section>\\n    <header class=\\\"ion-padding-start ion-padding-top\\\">¿Eres nuevo?</header>\\n    <ion-button expand=\\\"block\\\" color=\\\"primary\\\" class=\\\"ion-padding-horizontal\\\" routerLink=\\\"/signup\\\">\\n      Crear nueva cuenta</ion-button>\\n  </section>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { LoginPage } from './login.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LoginPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class LoginPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { IonicStorageModule } from '@ionic/storage';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LoginPageRoutingModule } from './login-routing.module';\n\nimport { LoginPage } from './login.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    LoginPageRoutingModule,\n    IonicStorageModule.forRoot()\n  ],\n  declarations: [LoginPage]\n})\nexport class LoginPageModule {}\n","export default \"ion-content {\\n  --ion-background-color: #ECECEC;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvbG9naW4vbG9naW4ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksK0JBQUE7QUFDSiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2xvZ2luL2xvZ2luLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImlvbi1jb250ZW50IHtcbiAgICAtLWlvbi1iYWNrZ3JvdW5kLWNvbG9yOiAjRUNFQ0VDO1xuICB9XG5cbiJdfQ== */\";","import { Component, OnInit } from '@angular/core';\nimport { NavigationExtras, Router } from '@angular/router';\nimport { GooglePlus } from '@ionic-native/google-plus/ngx';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport * as firebase from 'firebase/app';\nimport { Platform } from '@ionic/angular';\nimport { Facebook, FacebookLoginResponse } from '@ionic-native/facebook/ngx';\nimport { AppComponent } from \"../../app.component\";\nimport * as $ from \"jquery\";\nimport { AlertController } from '@ionic/angular';\nimport { environment } from '../../../environments/environment';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.page.html',\n  styleUrls: ['./login.page.scss'],\n})\n\nexport class LoginPage implements OnInit {\n  loading: any;\n  public id_user: string;\n  private email: string = \"\";\n  private pass: string = \"\";\n  verificado: boolean;\n  constructor(\n    private router: Router,\n    private platform: Platform,\n    private google: GooglePlus,\n    private fireAuth: AngularFireAuth,\n    private fb: Facebook,\n    private App: AppComponent,\n    private alertController: AlertController\n  ) {\n\n  }\n\n  ngOnInit() {\n\n  }\n\n\n  async login() {\n    var data = {\n      \"correo\": this.email,\n      \"clave\": this.pass\n    }\n    var self = this;\n    var url = environment.url + \"/api/login_participante/\"\n    await $.post(url, data).done(function (user) {\n      if (!user.error) {\n        self.App.id_User = user.id;\n        self.habilitarOpciones();\n        self.App.storage.set(\"user\", data.correo);\n        self.App.storage.set(\"pass\", data.clave);\n        self.App.storage.set(\"id\", user.id);\n        self.App.storage.get(\"id\").then((value) => {\n          console.log(value);\n        })\n      }\n      else {\n        self.alertError(user.mensaje, \"Credenciales incorrectas\");\n      }\n    });\n  }\n\n  async verificarCuenta(res: any) {\n    var self = this;\n\n    var data = {\n      \"correo\": res['email'],\n      \"nombres\": res['given_name'],\n      \"apellidos\": res['family_name']\n    }\n    await $.post(environment.url + \"/api/existe_participante/\", data).done(function (user) {\n      if (!user.error) {\n        self.App.id_User = user.id;\n        self.habilitarOpciones();\n      }\n      else {\n        let navigationExtras: NavigationExtras = {\n          queryParams: {\n            user: JSON.stringify(data)\n          }\n        };\n        self.alertError(\"Complete los datos faltantes para completar su registro\", \"Inicio exitoso\");\n        self.router.navigate([\"/signup/\"], navigationExtras);\n      }\n    })\n  }\n\n  async loginGoogle() {\n    let params;\n    if (this.platform.is('android')) {\n      params = {\n        'webClientId': '44397923925-udqfaidjvqhp8p7ule0oihpn4i3co6je.apps.googleusercontent.com',\n        'offline': true\n      }\n      this.google.login(params)\n        .then((response) => {\n          const { idToken, accessToken } = response\n          this.onLoginSuccess(idToken, accessToken);\n        }).catch((error) => {\n          console.log(error)\n          alert('error:' + JSON.stringify(error))\n        });\n    }\n    else {\n      this.loginGoogleWeb();\n    }\n  }\n\n  loginFacebook() {\n    if (this.platform.is('android')) {\n      this.loginFacebookAndroid();\n    } else {\n      this.loginFacebookWeb();\n    }\n  }\n\n  async loginGoogleWeb() {\n    const res = await this.fireAuth.auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());\n    this.verificarCuenta(res.additionalUserInfo.profile);\n  }\n\n  async loginFacebookAndroid() {\n    const res: FacebookLoginResponse = await this.fb.login(['public_profile', 'email']);\n    const facebookCredential = firebase.auth.FacebookAuthProvider.credential(res.authResponse.accessToken);\n    const resConfirmed = await this.fireAuth.auth.signInWithCredential(facebookCredential);\n    this.verificarCuenta(resConfirmed.additionalUserInfo.profile);\n  }\n\n  async loginFacebookWeb() {\n    const res = await this.fireAuth.auth.signInWithPopup(new firebase.auth.FacebookAuthProvider());\n    this.verificarCuenta(res.additionalUserInfo.profile);\n  }\n\n  onLoginSuccess(accessToken, accessSecret) {\n    const credential = accessSecret ? firebase.auth.GoogleAuthProvider\n      .credential(accessToken, accessSecret) : firebase.auth.GoogleAuthProvider\n        .credential(accessToken);\n    this.fireAuth.auth.signInWithCredential(credential)\n      .then((response) => {\n        this.verificarCuenta(response.additionalUserInfo.profile);\n      })\n  }\n\n\n\n  habilitarOpciones() {\n    this.App.estadoUser = true;\n    for (let i = 0; i < this.App.listMenu.length; i++) {\n      this.App.listMenu[i].disable = false;\n    }\n\n    for (let i = 0; i < this.App.listTabs.length; i++) {\n      this.App.listTabs[i].disable = false;\n    }\n    this.router.navigate([\"/educ/home/\"]);\n  }\n\n  async alertError(msg: string, msg2: string) {\n    const alert = await this.alertController.create({\n      header: msg2,\n      message: msg,\n      buttons: ['OK']\n    });\n\n    await alert.present();\n  }\n\n}\n\n"]}