{"version":3,"sources":["webpack:///src/app/pages/login/login.page.html","webpack:///src/app/pages/login/login-routing.module.ts","webpack:///src/app/pages/login/login.module.ts","webpack:///src/app/pages/login/login.page.scss","webpack:///src/app/pages/login/login.page.ts"],"names":["routes","path","component","LoginPageRoutingModule","imports","forChild","exports","LoginPageModule","declarations","LoginPage","router","platform","google","fireAuth","fb","App","alertController","email","pass","data","self","url","done","user","error","id_User","id","habilitarOpciones","alertError","mensaje","res","navigationExtras","queryParams","JSON","stringify","navigate","is","params","login","then","response","idToken","accessToken","onLoginSuccess","console","log","alert","loginGoogleWeb","loginFacebookAndroid","loginFacebookWeb","auth","signInWithPopup","GoogleAuthProvider","verificarCuenta","additionalUserInfo","profile","facebookCredential","FacebookAuthProvider","credential","authResponse","signInWithCredential","resConfirmed","accessSecret","estadoUser","i","listMenu","length","disable","listTabs","msg","msg2","create","header","message","buttons","present","selector","template"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACKf,UAAMA,MAAM,GAAW,CACrB;AACEC,YAAI,EAAE,EADR;AAEEC,iBAAS,EAAE;AAFb,OADqB,CAAvB;;UAWaC,sBAAsB;AAAA;AAAA,O;;AAAtBA,4BAAsB,6DAJlC,+DAAS;AACRC,eAAO,EAAE,CAAC,6DAAaC,QAAb,CAAsBL,MAAtB,CAAD,CADD;AAERM,eAAO,EAAE,CAAC,4DAAD;AAFD,OAAT,CAIkC,GAAtBH,sBAAsB,CAAtB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCGAI,eAAe;AAAA;AAAA,O;;AAAfA,qBAAe,6DAT3B,+DAAS;AACRH,eAAO,EAAE,CACP,4DADO,EAEP,0DAFO,EAGP,0DAHO,EAIP,4EAJO,CADD;AAORI,oBAAY,EAAE,CAAC,qDAAD;AAPN,OAAT,CAS2B,GAAfD,eAAe,CAAf;;;;;;;;;;;;;;;;ACnBb;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCkBFE,SAAS;AAKpB,2BACUC,MADV,EAEUC,QAFV,EAGUC,MAHV,EAIUC,QAJV,EAKUC,EALV,EAMUC,GANV,EAOUC,eAPV,EAO0C;AAAA;;AANhC,eAAAN,MAAA,GAAAA,MAAA;AACA,eAAAC,QAAA,GAAAA,QAAA;AACA,eAAAC,MAAA,GAAAA,MAAA;AACA,eAAAC,QAAA,GAAAA,QAAA;AACA,eAAAC,EAAA,GAAAA,EAAA;AACA,eAAAC,GAAA,GAAAA,GAAA;AACA,eAAAC,eAAA,GAAAA,eAAA;AATF,eAAAC,KAAA,GAAgB,EAAhB;AACA,eAAAC,IAAA,GAAe,EAAf;AAWP;;AAfmB;AAAA;AAAA,qCAiBX,CAER;AAnBmB;AAAA;AAAA,kCAqBN;;;;;;;AACRC,0B,GAAK;AACP,kCAAS,KAAKF,KADP;AAEP,iCAAQ,KAAKC;AAFN,uB;AAILE,0B,GAAO,I;AACPC,yB,GAAI,uEAAYA,GAAZ,GAAgB,0B;;AACxB,6BAAM,4CAAOA,GAAP,EAAWF,IAAX,EAAiBG,IAAjB,CAAsB,UAAUC,IAAV,EAAgB;AACtC,4BAAG,CAACA,IAAI,CAACC,KAAT,EAAe;AACbJ,8BAAI,CAACL,GAAL,CAASU,OAAT,GAAmBF,IAAI,CAACG,EAAxB;AACAN,8BAAI,CAACO,iBAAL;AACD,yBAHD,MAIG;AACHP,8BAAI,CAACQ,UAAL,CAAgBL,IAAI,CAACM,OAArB,EAA6B,0BAA7B;AACA;AACL,uBARK,CAAN;;;;;;;;;AASD;AArCmB;AAAA;AAAA,0CAuCEC,GAvCF,EAuCW;;;;;;;AACzBV,0B,GAAO,I;AAEPD,0B,GAAM;AACR,kCAASW,GAAG,CAAC,OAAD,CADJ;AAER,mCAAUA,GAAG,CAAC,YAAD,CAFL;AAGR,qCAAYA,GAAG,CAAC,aAAD;AAHP,uB;;AAKV,6BAAM,4CAAO,uEAAYT,GAAZ,GAAgB,2BAAvB,EAAmDF,IAAnD,EAAyDG,IAAzD,CAA+D,UAAUC,IAAV,EAAgB;AAC/E,4BAAG,CAACA,IAAI,CAACC,KAAT,EAAe;AACbJ,8BAAI,CAACL,GAAL,CAASU,OAAT,GAAmBF,IAAI,CAACG,EAAxB;AACAN,8BAAI,CAACO,iBAAL;AACD,yBAHD,MAII;AACF,8BAAII,gBAAgB,GAAqB;AACvCC,uCAAW,EAAE;AACXT,kCAAI,EAAEU,IAAI,CAACC,SAAL,CAAef,IAAf;AADK;AAD0B,2BAAzC;AAKAC,8BAAI,CAACQ,UAAL,CAAgB,yDAAhB,EAA0E,gBAA1E;AACAR,8BAAI,CAACV,MAAL,CAAYyB,QAAZ,CAAqB,CAAC,UAAD,CAArB,EAAkCJ,gBAAlC;AACD;AACR,uBAdO,CAAN;;;;;;;;;AAeH;AA9DqB;AAAA;AAAA,wCAgEA;;;;;;;;;AAElB,0BAAI,KAAKpB,QAAL,CAAcyB,EAAd,CAAiB,SAAjB,CAAJ,EAAiC;AAC/BC,8BAAM,GAAG;AACP,yCAAe,yEADR;AAEP,qCAAW;AAFJ,yBAAT;AAIA,6BAAKzB,MAAL,CAAY0B,KAAZ,CAAkBD,MAAlB,EACGE,IADH,CACQ,UAACC,QAAD,EAAc;AAAA,8BACVC,OADU,GACeD,QADf,CACVC,OADU;AAAA,8BACDC,WADC,GACeF,QADf,CACDE,WADC;;AAElB,+BAAI,CAACC,cAAL,CAAoBF,OAApB,EAA6BC,WAA7B;AACD,yBAJH,WAIW,UAAClB,KAAD,EAAW;AAClBoB,iCAAO,CAACC,GAAR,CAAYrB,KAAZ;AACAsB,+BAAK,CAAC,WAAWb,IAAI,CAACC,SAAL,CAAeV,KAAf,CAAZ,CAAL;AACD,yBAPH;AAQD,uBAbD,MAcK;AACH,6BAAKuB,cAAL;AACD;;;;;;;;;AACF;AAnFmB;AAAA;AAAA,0CAqFJ;AACd,gBAAI,KAAKpC,QAAL,CAAcyB,EAAd,CAAiB,SAAjB,CAAJ,EAAiC;AAC/B,mBAAKY,oBAAL;AACD,aAFD,MAEO;AACL,mBAAKC,gBAAL;AACD;AACF;AA3FmB;AAAA;AAAA,2CA6FG;;;;;;;;AACT,6BAAM,KAAKpC,QAAL,CAAcqC,IAAd,CAAmBC,eAAnB,CAAmC,IAAI,kDAAcC,kBAAlB,EAAnC,CAAN;;;AAANtB,yB;AACN,2BAAKuB,eAAL,CAAqBvB,GAAG,CAACwB,kBAAJ,CAAuBC,OAA5C;;;;;;;;;AACD;AAhGmB;AAAA;AAAA,iDAkGS;;;;;;;;AACQ,6BAAM,KAAKzC,EAAL,CAAQwB,KAAR,CAAc,CAAC,gBAAD,EAAmB,OAAnB,CAAd,CAAN;;;AAA7BR,yB;AACA0B,wC,GAAqB,kDAAcC,oBAAd,CAAmCC,UAAnC,CAA8C5B,GAAG,CAAC6B,YAAJ,CAAiBjB,WAA/D,C;;AACN,6BAAM,KAAK7B,QAAL,CAAcqC,IAAd,CAAmBU,oBAAnB,CAAwCJ,kBAAxC,CAAN;;;AAAfK,kC;AACN,2BAAKR,eAAL,CAAqBQ,YAAY,CAACP,kBAAb,CAAgCC,OAArD;;;;;;;;;AACD;AAvGmB;AAAA;AAAA,6CAyGK;;;;;;;;AACX,6BAAM,KAAK1C,QAAL,CAAcqC,IAAd,CAAmBC,eAAnB,CAAmC,IAAI,kDAAcM,oBAAlB,EAAnC,CAAN;;;AAAN3B,yB;AACN,2BAAKuB,eAAL,CAAqBvB,GAAG,CAACwB,kBAAJ,CAAuBC,OAA5C;;;;;;;;;AACD;AA5GmB;AAAA;AAAA,yCA8GLb,WA9GK,EA8GQoB,YA9GR,EA8GsB;AAAA;;AACxC,gBAAMJ,UAAU,GAAGI,YAAY,GAAG,kDAAcV,kBAAd,CAC/BM,UAD+B,CACpBhB,WADoB,EACPoB,YADO,CAAH,GACY,kDAAcV,kBAAd,CACtCM,UADsC,CAC3BhB,WAD2B,CAD3C;AAGA,iBAAK7B,QAAL,CAAcqC,IAAd,CAAmBU,oBAAnB,CAAwCF,UAAxC,EACGnB,IADH,CACQ,UAACC,QAAD,EAAc;AAClB,oBAAI,CAACa,eAAL,CAAqBb,QAAQ,CAACc,kBAAT,CAA4BC,OAAjD;AACD,aAHH;AAID;AAtHmB;AAAA;AAAA,8CA0HA;AAClB,iBAAKxC,GAAL,CAASgD,UAAT,GAAsB,IAAtB;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKjD,GAAL,CAASkD,QAAT,CAAkBC,MAAtC,EAA8CF,CAAC,EAA/C,EAAmD;AACjD,mBAAKjD,GAAL,CAASkD,QAAT,CAAkBD,CAAlB,EAAqBG,OAArB,GAA+B,KAA/B;AACD;;AAED,iBAAK,IAAIH,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAG,KAAKjD,GAAL,CAASqD,QAAT,CAAkBF,MAAtC,EAA8CF,EAAC,EAA/C,EAAmD;AACjD,mBAAKjD,GAAL,CAASqD,QAAT,CAAkBJ,EAAlB,EAAqBG,OAArB,GAA+B,KAA/B;AACD;;AACD,iBAAKzD,MAAL,CAAYyB,QAAZ,CAAqB,CAAC,aAAD,CAArB;AACD;AApImB;AAAA;AAAA,qCAsIHkC,GAtIG,EAsIQC,IAtIR,EAsIqB;;;;;;;;AACzB,6BAAM,KAAKtD,eAAL,CAAqBuD,MAArB,CAA4B;AAC9CC,8BAAM,EAAEF,IADsC;AAE9CG,+BAAO,EAAEJ,GAFqC;AAG9CK,+BAAO,EAAE,CAAC,IAAD;AAHqC,uBAA5B,CAAN;;;AAAR5B,2B;;AAMN,6BAAMA,KAAK,CAAC6B,OAAN,EAAN;;;;;;;;;AACD;AA9ImB;;AAAA;AAAA,S;;;;gBAjBK;;gBAIlB;;gBAHA;;gBACA;;gBAGA;;gBACA;;gBAEA;;;;AASIlE,eAAS,6DANrB,gEAAU;AACTmE,gBAAQ,EAAE,WADD;AAETC,gBAAQ,EAAR;AAAA;AAAA,kGAFS;;;;AAAA,OAAV,CAMqB,GAATpE,SAAS,CAAT","file":"pages-login-login-module-es5.js","sourcesContent":["export default \"<ion-content>\\n  <div class=\\\"vertical-center\\\">\\n    <img src=\\\"assets/images/LogoCEC.png\\\" class=\\\"smallLogo\\\" />\\n  </div>\\n  <ion-text color=\\\"primary\\\" class=\\\"color-h3\\\">\\n    <h3>Iniciar Sesión</h3>\\n  </ion-text>\\n    <ion-list>\\n      <ion-item>\\n        <ion-label position=\\\"stacked\\\">Correo electrónico</ion-label>\\n        <ion-input [(ngModel)]=\\\"email\\\" name=\\\"correo\\\" autocomplete=\\\"on\\\" type=\\\"email\\\"><ion-icon name=\\\"mail-outline\\\"></ion-icon></ion-input>\\n      </ion-item>\\n\\n      <ion-item>\\n        <ion-label position=\\\"stacked\\\">Contraseña</ion-label>\\n        <ion-input [(ngModel)]=\\\"pass\\\" autocomplete=\\\"off\\\" name=\\\"clave\\\" type=\\\"password\\\"><ion-icon name=\\\"keypad-outline\\\"></ion-icon></ion-input>\\n      </ion-item>\\n\\n      <ion-item lines=\\\"none\\\">\\n        <a routerLink=\\\"/educ/home/\\\" slot=\\\"end\\\">No iniciar sesión</a>\\n      </ion-item>\\n    </ion-list>\\n    <ion-button expand=\\\"block\\\" color=\\\"primary\\\" class=\\\"ion-padding-horizontal\\\" (click)=\\\"login()\\\">Iniciar Sesión</ion-button>\\n\\n  <!--header class=\\\"ion-padding-start ion-padding-top\\\"></!--header-->\\n  <ion-button expand=\\\"block\\\" color=\\\"tertiary\\\" (click)=\\\"loginFacebook()\\\" class=\\\"ion-padding-horizontal\\\">\\n    <ion-icon slot=\\\"start\\\" name=\\\"logo-facebook\\\"></ion-icon>\\n    Iniciar Sesión con Facebook\\n  </ion-button>\\n\\n  <ion-button expand=\\\"block\\\" color=\\\"danger\\\" (click)=\\\"loginGoogle()\\\" class=\\\"ion-padding-horizontal\\\">\\n    <ion-icon slot=\\\"start\\\" name=\\\"logo-google\\\"></ion-icon>\\n    Iniciar Sesión con Google\\n  </ion-button>\\n\\n  <section>\\n    <header class=\\\"ion-padding-start ion-padding-top\\\">¿Eres nuevo?</header>\\n    <ion-button expand=\\\"block\\\" color=\\\"primary\\\" class=\\\"ion-padding-horizontal\\\" routerLink=\\\"/signup\\\">\\n      Crear nueva cuenta</ion-button>\\n  </section>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { LoginPage } from './login.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LoginPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class LoginPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LoginPageRoutingModule } from './login-routing.module';\n\nimport { LoginPage } from './login.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    LoginPageRoutingModule\n  ],\n  declarations: [LoginPage]\n})\nexport class LoginPageModule {}\n","export default \"ion-content {\\n  --ion-background-color: #ECECEC;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvbG9naW4vbG9naW4ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksK0JBQUE7QUFDSiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2xvZ2luL2xvZ2luLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImlvbi1jb250ZW50IHtcbiAgICAtLWlvbi1iYWNrZ3JvdW5kLWNvbG9yOiAjRUNFQ0VDO1xuICB9XG5cbiJdfQ== */\";","import { Component,OnInit } from '@angular/core';\nimport { NavigationExtras, Router} from '@angular/router';\nimport { GooglePlus } from '@ionic-native/google-plus/ngx';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport * as firebase from 'firebase/app';\nimport { Platform } from '@ionic/angular';\nimport { Facebook, FacebookLoginResponse } from '@ionic-native/facebook/ngx';\nimport { AppComponent } from \"../../app.component\";\nimport * as $ from \"jquery\";\nimport { AlertController } from '@ionic/angular';\nimport {environment} from '../../../environments/environment';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.page.html',\n  styleUrls: ['./login.page.scss'],\n})\n\nexport class LoginPage implements OnInit {\n  loading: any;\n  public id_user: string;\n  private email: string = \"\";\n  private pass: string = \"\";\n  constructor(\n    private router: Router,\n    private platform: Platform,\n    private google: GooglePlus,\n    private fireAuth: AngularFireAuth,\n    private fb: Facebook,\n    private App: AppComponent,\n    private alertController: AlertController\n  ) {\n  \n  }\n\nngOnInit() {\n\n  }\n\n  async login() {\n    var data={\n      \"correo\":this.email,\n      \"clave\":this.pass\n    }\n    var self = this;\n    var url=environment.url+\"/api/login_participante/\"\n    await $.post(url,data).done(function (user) {\n          if(!user.error){\n            self.App.id_User = user.id;\n            self.habilitarOpciones();\n          }          \n         else{\n          self.alertError(user.mensaje,\"Credenciales incorrectas\");\n         }\n    });\n  }\n\n  async verificarCuenta(res:any) {\n    var self = this;\n    \n    var data ={\n      \"correo\":res['email'],\n      \"nombres\":res['given_name'],\n      \"apellidos\":res['family_name']\n    }\n    await $.post(environment.url+\"/api/existe_participante/\",data).done( function (user) {\n          if(!user.error){\n            self.App.id_User = user.id;\n            self.habilitarOpciones();\n          }\n          else{\n            let navigationExtras: NavigationExtras = {\n              queryParams: {\n                user: JSON.stringify(data)\n              }\n            };\n            self.alertError(\"Complete los datos faltantes para completar su registro\",\"Inicio exitoso\");\n            self.router.navigate([\"/signup/\"],navigationExtras);\n          }\n  })\n}\n\n  async loginGoogle() {\n    let params;\n    if (this.platform.is('android')) {\n      params = {\n        'webClientId': '44397923925-udqfaidjvqhp8p7ule0oihpn4i3co6je.apps.googleusercontent.com',\n        'offline': true\n      }\n      this.google.login(params)\n        .then((response) => {\n          const { idToken, accessToken } = response\n          this.onLoginSuccess(idToken, accessToken);\n        }).catch((error) => {\n          console.log(error)\n          alert('error:' + JSON.stringify(error))\n        });\n    }\n    else {\n      this.loginGoogleWeb();\n    }\n  }\n\n  loginFacebook() {\n    if (this.platform.is('android')) {\n      this.loginFacebookAndroid();\n    } else {\n      this.loginFacebookWeb();\n    }\n  }\n\n  async loginGoogleWeb() {\n    const res = await this.fireAuth.auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());\n    this.verificarCuenta(res.additionalUserInfo.profile);\n  }\n\n  async loginFacebookAndroid() {\n    const res: FacebookLoginResponse = await this.fb.login(['public_profile', 'email']);\n    const facebookCredential = firebase.auth.FacebookAuthProvider.credential(res.authResponse.accessToken);\n    const resConfirmed = await this.fireAuth.auth.signInWithCredential(facebookCredential);\n    this.verificarCuenta(resConfirmed.additionalUserInfo.profile);\n  }\n\n  async loginFacebookWeb() {\n    const res = await this.fireAuth.auth.signInWithPopup(new firebase.auth.FacebookAuthProvider());\n    this.verificarCuenta(res.additionalUserInfo.profile);\n  }\n\n  onLoginSuccess(accessToken, accessSecret) {\n    const credential = accessSecret ? firebase.auth.GoogleAuthProvider\n      .credential(accessToken, accessSecret) : firebase.auth.GoogleAuthProvider\n        .credential(accessToken);\n    this.fireAuth.auth.signInWithCredential(credential)\n      .then((response) => {\n        this.verificarCuenta(response.additionalUserInfo.profile);\n      })\n  }\n\n\n\n  habilitarOpciones() {\n    this.App.estadoUser = true;\n    for (let i = 0; i < this.App.listMenu.length; i++) {\n      this.App.listMenu[i].disable = false;\n    }\n\n    for (let i = 0; i < this.App.listTabs.length; i++) {\n      this.App.listTabs[i].disable = false;\n    }\n    this.router.navigate([\"/educ/home/\"]);\n  }\n\n  async alertError(msg:string,msg2:string) {\n    const alert = await this.alertController.create({\n      header: msg2,\n      message: msg,\n      buttons: ['OK']\n    });\n\n    await alert.present();\n  }\n\n}\n\n"]}